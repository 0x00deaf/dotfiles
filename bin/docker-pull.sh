REPO=docker-local.repo.srv.rkr.hkg
DOCKER_DIR=~/src/docker
DOCKER_IMAGE=$1

if [[ -z "$2" ]];
then
	TARGET_DIR=$DOCKER_DIR/$DOCKER_IMAGE
	FROM_IMAGE=$REPO/$DOCKER_IMAGE
else
	DOCKER_TAG=$2
	TARGET_DIR=$DOCKER_DIR/$DOCKER_IMAGE_$DOCKER_TAG
	FROM_IMAGE=$REPO/$DOCKER_IMAGE:$DOCKER_TAG
fi

mkdir -p $TARGET_DIR && cd $TARGET_DIR
echo "from $FROM_IMAGE" > $TARGET_DIR/Dockerfile
docker build -t $FROM_IMAGE $TARGET_DIR

export DOCKER_RESULT_IMAGE=$FROM_IMAGE
